订单服务主要有：

- 获取未乘坐订单

  在 redis 上查询是否有相应数据，如果没有则在数据库中查询并插入redis中，如果有的话，检查当前的 redis 数据是否有效，即获取未乘坐订单中判断当前时间是否大于发车时间，如果大于则删除 redis，重新写。

- 获取未支付订单

  首先在 redis 上获取，有则从 redis 上获取，没有则从数据库中获取并写入 redis

- 添加订单

  添加订单主要是在数据库中插入新的订单，同时删除场次和未支付缓存，因为这两个缓存同时需要更新。

- 订单详情

- 更改订单状态

# 添加订单

1. 首先判断座位号是否重复了，调用班车服务下的 `repeatSeats` 方法，判断是否有重复。
2. 再调用班车服务下的 `addSeats` 添加占座。
3. 再根据占座数量计算总金额
4. 再将订单插入 oder 表中。
5. 同时将未支付的订单加入 redis 中。
6. 在上述流程中，如果哪部分出现异常均会将该订单加入MQ中，由MQ进行消费回滚数据。