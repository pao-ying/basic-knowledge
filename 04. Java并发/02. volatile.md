# 并发编程三个概念

- 原子性

  一个操作或者多个操作要么都执行，要么都不执行

- 可见性

  多个线程访问同一变量时，一个线程修改了变量的值，其他线程能够立即看到修改的值

- 有序性

  程序执行的顺序按照代码的先后顺序执行

# 内存模型JMM

主要目标是定义程序中各个变量的访问规则。

JMM中规定所有变量都存储在**主内存**中，每条线程有自己的**工作内存**，线程对变量的操作都必须在工作内存中进行，而不能直接读写主内存中的变量。

**工作内存**是JMM的抽象概念，也叫**本地内存**，存储了该线程共享变量的副本。

## 原子性

JMM中只保证了**基本读取**和**赋值**是原子操作，如**i++**等都不是原子操作。实现原子操作需要使用锁。

## 可见性

JMM使用**volatile**保证可见性。

当共享变量被volatile修饰时，保证修改的值会立即更新到**主存**上，并且其它线程读取时，会去内存上读取新值。

## 有序性

JMM中，允许**编译器和处理器**进行指令重排，会影响到多线程的执行。JMM中，可以通过volatile关键字保证有序性

# 总结

## volatile作用

- 保证不同线程对变量操作的可见性，

  即一个线程修改了变量的值，volatile能够保证新值立即同步到主存上,而且每次使用时立即从主内存上刷新.

- 禁止进行指令重排

