# 进程与线程

## 定义

进程是系统进行资源分配和调度的基本单位。

线程是CPU调度和分派的基本单位。

## 关系

一个进程可以有多个线程，多个线程之间可以并发执行。

多个进程间是相互独立的，但是同一进程下的线程可能会相互影响。

## 比较

- 开销

  进程创建和销毁，系统都需要为之分配和回收资源，导致系统的开销要大于线程的开销。

- 调度

  进程作为资源分配的基本单位，线程作为CPU调度的基本单位

- 并发性

  进程间可以并发执行，进程间也可以并发执行

- 拥有资源

  进程是系统中拥有资源的基本单位，线程不拥有资源，但可以访问隶属的进程资源。

# 进程有几种状态

- 创建状态

- 就绪状态

  获得了除CPU以外的所有资源

- 运行状态

- 阻塞状态

  进程正在等待某一事件完成，如等待某一资源可用或者等待IO操作。即使CPU空闲，也不能使用。

- 结束状态

  进程从系统消失。如进程正常结束或中断退出。

# 进程间的通信方式

- 管道/匿名管道

  具有父子关系或兄弟关系间进程通信

- 有名管道

  有名管道遵循**先进先出**原则，以磁盘文件的方式存在，可以实现本机任意两个线程通信。

- 信号

  用于通知某个进程某个事件已经发生

- 消息队列

  匿名管道存在于内存中，有名管道存在于磁盘中，而消息队列存在于内核中。

  消息队列可实现消息的随即查询。

- 信号量

  信号量是一个计数器，主要用于进程间对共享数据的访问和进程同步。

- 共享内存

  使得多个进程可以同时访问一块内存空间，不同进程之间可以看到对方进程对共享内存中数据的更新。需要依靠互斥锁和信号量。

- 套接字

  主要用于客户端和服务器直接进行通信。

# 进程同步机制

- 互斥量

  采用互斥对象机制，只有拥有互斥对象的线程才能对公共资源进行访问

- 信号量

  允许同一时刻**多个**线程对共享资源进行访问，但需要控制同一时刻访问该资源的最大线程量

- 事件

  wait/notify。通过通知等待的方式来保持进程同步。

# 进程的调度算法

- 先到先服务调度算法FCFS

  从就绪队列中选择最先进入队列的进程**分配资源**，知道他执行完成，或者转变为阻塞状态时再**重新调度**。

- 短作业优先算法

  从就绪队列中选择**运行时间最短**的进程分配资源。

- 时间片轮转调度算法

  为每一个进程分配相同的时间段执行。

- 多级反馈队列调度算法

  多级反馈队列调度算法能够使高优先级进程得到响应同时短作业进程迅速完成，unix操作系统采取的是这种调度

- 优先级调度

  为每个进程分配优先级，高优先级先执行，相同优先级以先到先服务算法执行。