# FTP

HTTP和FTP都是文件传输协议，但是FTP使用两个并行的TCP连接来传输文件，一个是**控制连接**， 一个是**数据连接**。

控制连接用于在两个主机之间传输控制信息，数据连接主要用于实际传输文件。

当**用户主机**向**远程主机**发起FTP连接时，首先会在**21端口**上发起**控制连接**。远程主机接受到文件传输命令后，则在**20端口**上发起**数据连接**。

对于FTP传输而言，控制连接贯穿了整个**用户会话期间**，但是针对会话的每一次文件传输都需要建立一个新的数据连接。

# SMTP

SMTP主要提供电子邮件服务的协议。

具体流程：

- A用户撰写邮件并指示B用户邮箱地址，通过用户代理将报文发送到邮件服务器A，并存到**报文队列**中。
- **邮件服务器A创建TCP连接到邮件服务器B上**，然后将报文发送到邮件服务器B。
- 邮件服务器B收到报文后存入邮箱，B用户可以调用代理查看邮件。

SMTP中，若邮件服务器B未开启，则报文会继续留在邮件服务器A上，并继续尝试连接。