# ACID

- 原子性 atomicity

  事务是最小的执行单位，不允许分割。事务的原子性保证动作要么完成，要么都不完成。

- 一致性 consistency

  执行事务前后，数据保持一致

- 隔离性 isolation

  并发访问数据库时，各个事务之间不会干扰。

- 持久性 durability

  事务被提交后，对数据的改变是持久的，即使发生了故障也不会影响。

> 使用redo log 实现事务的一致性和持久性，使用MVCC实现了事务的隔离性和原子性。

# 并发事务产生的问题

- 脏读

  一个事务在处理过程中读取了另一个事务未提交的数据。

- 不可重复读

  对数据库表中的某行记录，一个事务进行了多次查询却返回了不同的数据。

  这是由于另一个事务在查询间隔中修改了数据并提交了。

- 幻读

  对数据库表中某个范围的数据进行查询时，事务多次查询的结果行数不同，即产生了幻行。

## 区别

### 脏读和不可重复读

脏读读取了另一个事务还未提交的数据；不可重复读是读取了事务提交的数据。

### 不可重复读和幻读

都是读取了已经提交了的事务数据，不同的是不可重复读重点在修改，而幻读的重点是新增或者删除。

# 隔离级别

## Read Uncommited

读未提交。即事务可以读取到其它未提交事务修改的数据。

## Read commited

读已提交。即事务只能够读取其它事务已经提交的数据。

可避免脏读。

## Repeatable Read

可重复读。即确保同一事务多次查询的结果一致。

可避免脏读和不可重复读

## Serializable

串行化。即强制进行事务排序，使之不会产生冲突，从而解决幻读问题。

# MySQL如何避免幻读

- 快照读使用MVCC
- 当前读使用next-key避免，通过行锁和间隙锁实现。